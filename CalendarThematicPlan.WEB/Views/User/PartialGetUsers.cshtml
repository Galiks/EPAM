@using Ninject
@using CalendarThematicPlan.Container
@using CalendarThematicPlan.BLL.Interface
@using CalendarThematicPlan.Entity

@{
    IUserLogic userLogic = NinjectCommon.Kernel.Get<IUserLogic>();
    List<User> users;
    if (IsPost)
    {
        string word = Request["search"];
        users = userLogic.GetUsersByWord(word).ToList();
    }
    else
    {
        users = userLogic.GetUsers().ToList();
    }
}

<link href="~/Content/styles.css" rel="stylesheet"/>

<div class="mb-5">

    <form method="post">
        <div class="form-group">
            <label for="search" class="control-label">
                Поиск по слову :
                <input type="text" id="search" name="search" class="form-control" />
            </label>
        </div>

        <button>Поиск</button>
    </form>

    <table class="border-dark" border="1">
        <tr>
            <td>ID</td>
            <td>Фамилия</td>
            <td>Имя</td>
            <td>Отчество</td>
            <td>Должность</td>
            <td>Фото</td>
            @if (User.IsInRole("Admin") || User.IsInRole("Moderator"))
            {
                <td>Доп действия (тест)</td>
            }
            </tr>
        @foreach (var item in users)
        {
    <tr class="align-middle">
        <td>@item.Id</td>
        <td>@item.LastName</td>
        <td>@item.FirstName</td>
        <td>@item.Patronymic</td>
        <td>@item.Position</td>
        <td>
            @if (item.UserPhoto != null)
            {
                @Html.Raw("<img class='user-img' src=\"data:image/jpeg;base64,"
                         + Convert.ToBase64String(item.UserPhoto) + "\" />")
            }
            else
            {
                <img style='width:80px; height:60px;' src="~/Images/user.jpg" />
            }
        </td>
        @if (User.IsInRole("Admin") || User.IsInRole("Moderator"))
        {
            <td>
                @Html.ActionLink("Details", "Details", new { id = item.Id })
                @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                @Html.ActionLink("Update", "Update", new { id = item.Id })
            </td>
        }
        </tr>
        }
    </table>
</div>
